<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helios: Powerball Anomaly Detection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.1.0",
    "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
    "react/": "https://esm.sh/react@^19.1.0/",
    "@google/genai": "https://esm.sh/@google/genai@^1.9.0",
    "chart.js": "https://esm.sh/chart.js@^4.4.3",
    "react-chartjs-2": "https://esm.sh/react-chartjs-2@^5.2.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-gray-900">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
    <!-- Full Stack Integration Test -->
    <script type="module">
        import { getApiBaseUrl, getApiEndpoint, getCurrentConfig } from './services/config.js';

        // Comprehensive integration test function
        window.testFullStack = async function() {
            console.log('ðŸ”— Helios Full Stack Integration Test');
            console.log('====================================');

            const config = getCurrentConfig();
            console.log('\nðŸ“‹ Configuration:');
            console.log('   Frontend URL:', window.location.origin);
            console.log('   Backend URL:', getApiBaseUrl());
            console.log('   Full Config:', config);

            let passedTests = 0;
            let totalTests = 0;

            // Test 1: Backend Health Check
            console.log('\nðŸ¥ Testing Backend Health...');
            totalTests++;
            try {
                const response = await fetch(getApiEndpoint('/health'));
                if (response.ok) {
                    const data = await response.json();
                    console.log('   âœ… Backend Health: PASSED');
                    console.log('   ðŸ“Š Response:', data);
                    passedTests++;
                } else {
                    console.log('   âŒ Backend Health: FAILED (Status:', response.status, ')');
                }
            } catch (error) {
                console.log('   âŒ Backend Health: ERROR -', error.message);
            }

            // Test 2: Models API
            console.log('\nðŸ¤– Testing Models API...');
            totalTests++;
            try {
                const response = await fetch(getApiEndpoint('/api/models'));
                if (response.ok) {
                    const data = await response.json();
                    console.log('   âœ… Models API: PASSED');
                    console.log('   ðŸ“Š Available models:', data);
                    passedTests++;
                } else {
                    console.log('   âŒ Models API: FAILED (Status:', response.status, ')');
                }
            } catch (error) {
                console.log('   âŒ Models API: ERROR -', error.message);
            }

            // Test 3: CORS Test
            console.log('\nðŸŒ Testing CORS Configuration...');
            totalTests++;
            try {
                const response = await fetch(getApiEndpoint('/health'), {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                if (response.ok) {
                    console.log('   âœ… CORS: PASSED');
                    passedTests++;
                } else {
                    console.log('   âš ï¸ CORS: Possible issues');
                }
            } catch (error) {
                console.log('   âŒ CORS: ERROR -', error.message);
            }

            // Results Summary
            console.log('\nï¿½ Test Results Summary');
            console.log('========================');
            console.log(`Total Tests: ${totalTests}`);
            console.log(`âœ… Passed: ${passedTests}`);
            console.log(`âŒ Failed: ${totalTests - passedTests}`);
            console.log(`Success Rate: ${Math.round((passedTests / totalTests) * 100)}%`);

            if (passedTests === totalTests) {
                console.log('\nðŸŽ‰ ALL TESTS PASSED! Full stack integration is working perfectly!');
            } else {
                console.log('\nâš ï¸ Some tests failed. Possible issues:');
                console.log('   â€¢ Backend server not running');
                console.log('   â€¢ Port mismatch in configuration');
                console.log('   â€¢ CORS configuration issues');
                console.log('   â€¢ Network connectivity problems');
            }

            return passedTests === totalTests;
        };

        // Simple connectivity test
        window.testConnection = async function() {
            console.log('ðŸ”— Quick Backend Connection Test...');
            try {
                const response = await fetch(getApiEndpoint('/health'));
                if (response.ok) {
                    const data = await response.json();
                    console.log('âœ… Backend Connected!');
                    console.log('ðŸ“Š Status:', data.status);
                    console.log('ðŸ”§ Service:', data.service);
                    return true;
                } else {
                    console.log('âš ï¸ Backend responded but with error:', response.status);
                    return false;
                }
            } catch (error) {
                console.log('âŒ Backend not accessible:', error.message);
                console.log('ðŸ’¡ Make sure Python backend is running on', getApiBaseUrl());
                return false;
            }
        };

        // Auto-test on load
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('ðŸš€ Helios Frontend Loaded Successfully!');
                console.log('ðŸ”§ Backend configured for:', getApiBaseUrl());
                console.log('');
                console.log('ðŸ’¡ Available test commands:');
                console.log('   testConnection()  - Quick backend test');
                console.log('   testFullStack()   - Comprehensive integration test');
                console.log('');

                // Auto-run quick test
                console.log('ðŸ”„ Running automatic connectivity test...');
                testConnection();
            }, 2000);
        });
    </script>
</body>
</html>
